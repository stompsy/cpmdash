{# Quick Stat Content for Modal Header - wrapped for HTMX selection #}
<div id="quick-stat-content">
    <div class="flex items-center gap-3">
        <div class="inline-flex items-center gap-1.5 rounded-md border border-indigo-200/70 bg-white/70 px-2.5 py-1 dark:border-indigo-500/20 dark:bg-slate-950/30">
            <span class="text-2xl font-bold leading-none text-indigo-600 dark:text-indigo-400">{{ total_types }}</span>
            <span class="text-xs font-semibold uppercase tracking-wide text-indigo-700 dark:text-indigo-300">types</span>
        </div>
        <div class="inline-flex items-center gap-1.5 rounded-md border border-indigo-200/70 bg-white/70 px-2.5 py-1 dark:border-indigo-500/20 dark:bg-slate-950/30">
            <span class="text-2xl font-bold leading-none text-indigo-600 dark:text-indigo-400">{{ total_referrals }}</span>
            <span class="text-xs font-semibold uppercase tracking-wide text-indigo-700 dark:text-indigo-300">total</span>
        </div>
    </div>
</div>

{# Main Table Content #}
<div id="table-content">
    <div class="border-b border-gray-200 dark:border-white/10 px-6 py-6 sm:py-8">
        <div class="flex flex-col gap-4">
            <div>
                <p class="text-xs font-semibold uppercase tracking-wide text-indigo-600 dark:text-indigo-400">Referral breakdown</p>
                <p class="mt-2 text-sm text-gray-600 dark:text-gray-400 w-full">
                    Combined view of all referral types across Referral Type 1-5 fields. Grouped by category and sorted by count within each group.
                </p>
                <div class="mt-4 flex items-start gap-4 w-full">
                    <div class="shrink-0">
                        <span class="inline-flex items-center rounded-md bg-yellow-400/10 px-2 py-1 text-xs font-medium text-yellow-500 inset-ring inset-ring-yellow-400/20">Attention:</span>
                    </div>
                    <p class="text-xs text-gray-600 dark:text-gray-400 w-full">
                        We didn’t start tracking individual referrals (and their detailed attributes) until Q4 2022.
                        Also, a single referral can include multiple services/types over time.
                        For example: one referral may start as a medical evaluation, then later that same referral can have additional types added (blood draw, medication administration, home health, durable medical equipment).
                        So the total “referrals” count will often be lower than the total “referral types” counted here.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <div class="overflow-x-auto">
        {% if referral_types %}
        <table class="min-w-full divide-y divide-gray-200 dark:divide-white/5 text-left">
            <thead class="bg-gray-50/80 dark:bg-white/5 text-xs uppercase tracking-wide text-gray-600 dark:text-gray-300">
                <tr>
                    <th scope="col" class="px-6 py-3">Referral Type</th>
                    <th scope="col" class="px-6 py-3">Count</th>
                    <th scope="col" class="px-6 py-3">Percentage</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-200/70 dark:divide-white/5 text-sm text-gray-700 dark:text-gray-200">
                {% for row in referral_types %}
                <tr class="{% if row.group_color == 0 %}bg-rose-50/50 dark:bg-rose-950/20{% elif row.group_color == 1 %}bg-amber-50/50 dark:bg-amber-950/20{% elif row.group_color == 2 %}bg-emerald-50/50 dark:bg-emerald-950/20{% elif row.group_color == 3 %}bg-cyan-50/50 dark:bg-cyan-950/20{% elif row.group_color == 4 %}bg-violet-50/50 dark:bg-violet-950/20{% elif row.group_color == 5 %}bg-pink-50/50 dark:bg-pink-950/20{% elif row.group_color == 6 %}bg-lime-50/50 dark:bg-lime-950/20{% else %}bg-sky-50/50 dark:bg-sky-950/20{% endif %} hover:bg-indigo-50/40 dark:hover:bg-indigo-500/10 transition-colors">
                    <td class="px-6 py-3 font-medium text-gray-900 dark:text-white">{{ row.type }}</td>
                    <td class="px-6 py-3">{{ row.count }}</td>
                    <td class="px-6 py-3">{{ row.percentage }}%</td>
                </tr>
                {% endfor %}
            </tbody>
            <tfoot class="border-t-2 border-indigo-200 dark:border-indigo-500/30 bg-indigo-50/50 dark:bg-indigo-900/20">
                <tr>
                    <td class="px-6 py-4 font-bold text-indigo-900 dark:text-indigo-100 uppercase text-xs tracking-wide">Total</td>
                    <td class="px-6 py-4 font-bold text-indigo-900 dark:text-indigo-100">{{ total_referrals }}</td>
                    <td class="px-6 py-4 font-bold text-indigo-900 dark:text-indigo-100">100.0%</td>
                </tr>
            </tfoot>
        </table>
        {% else %}
        <div class="px-6 py-12 text-center text-sm text-gray-600 dark:text-gray-300">
            No referral data available yet. Add referrals to populate this breakdown.
        </div>
        {% endif %}
    </div>
</div>
