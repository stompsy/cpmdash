{% extends "base.html" %}
{% block title %}
    {% if object %}Edit Case Study{% else %}New Case Study{% endif %}
{% endblock title %}
{% block content %}
    <section class="col-span-12">
        <div class="mx-auto max-w-5xl">
            <div class="relative overflow-hidden rounded-[2.5rem] border border-white/5 bg-[linear-gradient(135deg,#101a2c_0%,#111f30_52%,#0b1826_100%)] p-10 shadow-[0_24px_60px_rgba(8,47,73,0.36)]">
                <div class="pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_top_left,rgba(94,234,212,0.12),transparent_60%)]"></div>
                <div class="relative space-y-10">
                    <header class="space-y-4">
                        <p class="inline-flex items-center gap-2 rounded-full bg-white/5 px-4 py-1 text-[11px] font-semibold uppercase tracking-[0.35em] text-brand-200/90">
                            {% if object %}Update clinical case record{% else %}Create clinical case record{% endif %}
                        </p>
                        <h1 class="text-3xl font-semibold tracking-tight text-white sm:text-4xl">
                            {% if object %}Edit case study: {{ object.title }}{% else %}Create a new case study{% endif %}
                        </h1>
                        <p class="max-w-3xl text-base leading-relaxed text-slate-300">
                            Document operational details, outcomes, and focus areas for this community paramedicine case. Published entries populate the case registry once approved.
                        </p>
                    </header>
                    <form method="post" enctype="multipart/form-data" class="space-y-8">
                        {% csrf_token %}
                        {% for hidden in form.hidden_fields %}
                            {{ hidden }}
                        {% endfor %}
                        {% if form.non_field_errors %}
                            <div class="rounded-2xl border border-rose-500/50 bg-rose-500/10 px-6 py-4 text-sm text-rose-100">
                                {% for error in form.non_field_errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                        <div class="grid gap-6 md:grid-cols-2">
                            {% for field in form.visible_fields %}
                                <div class="{% if field.field.widget.input_type == 'textarea' or field.field.widget.input_type == 'selectmultiple' or field.name == 'content' or field.name == 'excerpt' %}md:col-span-2{% else %}md:col-span-1{% endif %} space-y-3">
                                    {% if field.field.widget.input_type == 'checkbox' %}
                                        <div class="flex items-start gap-4 rounded-2xl border border-white/10 bg-slate-900/60 px-4 py-4">
                                            {{ field }}
                                            <div class="space-y-1">
                                                <label for="{{ field.id_for_label }}" class="text-sm font-semibold text-slate-100">{{ field.label }}</label>
                                                {% if field.help_text %}
                                                    <p class="text-xs text-slate-400">{{ field.help_text }}</p>
                                                {% endif %}
                                                {% for error in field.errors %}
                                                    <p class="text-xs text-rose-300">{{ error }}</p>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    {% else %}
                                        <label for="{{ field.id_for_label }}" class="mb-2 block text-sm font-semibold text-slate-200">{{ field.label }}</label>
                                        {{ field }}
                                        {% if field.help_text %}
                                            <p class="mt-2 text-xs text-slate-400">{{ field.help_text }}</p>
                                        {% endif %}
                                        {% for error in field.errors %}
                                            <p class="mt-2 text-xs text-rose-300">{{ error }}</p>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                            {% endfor %}
                        </div>
                        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
                            <div class="text-xs uppercase tracking-[0.35em] text-slate-400">
                                {% if object %}Last updated {{ object.updated_at|date:"M d, Y H:i" }} UTC{% else %}Draft will auto-save on submit{% endif %}
                            </div>
                            <div class="flex flex-wrap gap-3">
                                {% if object %}
                                    <a href="{{ object.get_absolute_url }}" class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-5 py-2 text-sm font-semibold text-slate-200 transition hover:border-brand-400/60 hover:bg-brand-500/15 hover:text-white">Cancel</a>
                                {% else %}
                                    <a href="{% url 'blog:list' %}" class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-5 py-2 text-sm font-semibold text-slate-200 transition hover:border-brand-400/60 hover:bg-brand-500/15 hover:text-white">Cancel</a>
                                {% endif %}
                                <button type="submit" class="inline-flex items-center gap-2 rounded-full bg-brand-500/80 px-6 py-2.5 text-sm font-semibold text-slate-900 shadow transition hover:bg-brand-400">
                                    {% if object %}Update case study{% else %}Create case study{% endif %}
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
{% endblock content %}
